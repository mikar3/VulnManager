using System.ComponentModel.DataAnnotations;
using System.ComponentModel.DataAnnotations.Schema;
using VulnManager.Data;
using VulnManager.Models;
using System.Text;
using Microsoft.EntityFrameworkCore;

namespace VulnManager.Models
{

    public class Vulnerability
    {
        [Key]
        [DatabaseGenerated(DatabaseGeneratedOption.Identity)]
        public string Id { get; set; }
        public enum State
        {
            New,
            [Display(Name = "False positive")]
            FalsePositive,
            [Display(Name = "Not to fix")]
            NotToFix,
            Fixed
        }
        [Display(Name = "Vulnerability state")]
        public State VulnerabilityState { get; set; }
        public Server Server { get; set; }
        [Required]
        public string ServerId { get; set; }
        private readonly ApplicationDbContext _context;
        public Cve Cve { get; set; }
        [Required]
        public string CveName { get; set; }

        public Vulnerability(string cveName, string serverId)
        {
            CveName = cveName;
            ServerId = serverId;
            VulnerabilityState = State.New;
        }

    }
}

