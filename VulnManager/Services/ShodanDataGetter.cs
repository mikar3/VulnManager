using VulnManager.Data;
using System.ComponentModel.DataAnnotations;
using System.ComponentModel.DataAnnotations.Schema;
using System.Linq;
using VulnManager.Models;
using VulnManager.Services;
using System.Text.Json;
using System.Net;
using Microsoft.EntityFrameworkCore;

namespace VulnManager.Services
{
    public class ShodanDataGetter
    {
        private readonly ApplicationDbContext _context;
        private readonly string apiKey = "qNz6gnKXkbWdt1txXYHoyy5FV77YhD2W";
        private readonly HttpClient _httpClient;

        public ShodanDataGetter(ApplicationDbContext context, HttpClient httpClient)
        {
            _context = context;
            _httpClient = httpClient;
        }

        public async Task<ShodanInfo> ScanIpAsync(string ip, Uri uri)
        {
            var shodanResponse = await _httpClient.GetAsync(uri);
            if (shodanResponse.StatusCode != HttpStatusCode.OK)
            {
                throw new Exception("Error: code: " + shodanResponse.StatusCode.ToString());
            }
            var shodanResponseString = await shodanResponse.Content.ReadAsStringAsync();
            //var shodanResponseString = "{\"city\": \"Frankfurt am Main\", \"country_name\": \"Germany\", \"region_code\": \"HE\", \"os\": null, \"tags\": [\"self-signed\", \"starttls\"], \"ip\": 1041894504, \"isp\": \"ecotel communication ag\", \"area_code\": null, \"longitude\": 8.68417, \"last_update\": \"2022-02-04T02:46:34.178244\", \"ports\": [80, 443, 21, 22], \"latitude\": 50.11552, \"hostnames\": [], \"country_code\": \"DE\", \"vulns\": [\"CVE-2014-8109\", \"CVE-2015-3185\", \"CVE-2016-8612\", \"CVE-2017-7679\", \"CVE-2019-0220\", \"CVE-2017-9788\", \"CVE-2016-0736\", \"CVE-2014-3583\", \"CVE-2017-15710\", \"CVE-2018-1283\", \"CVE-2015-3184\", \"CVE-2017-3167\", \"CVE-2017-9798\", \"CVE-2016-8743\", \"CVE-2017-15715\", \"CVE-2017-7668\", \"CVE-2017-3169\", \"CVE-2016-4975\", \"CVE-2018-17199\", \"CVE-2016-2161\", \"CVE-2018-1312\"], \"domains\": [], \"org\": \"NetLeaders GmbH & Co. KG\", \"data\": [{\"ftp\": {\"features\": {\"PROT\": {\"parameters\": []}, \"AUTH\": {\"parameters\": [\"TLS\"]}, \"PBSZ\": {\"parameters\": []}, \"PASV\": {\"parameters\": []}, \"REST\": {\"parameters\": [\"STREAM\"]}, \"EPSV\": {\"parameters\": []}, \"TVFS\": {\"parameters\": []}, \"EPRT\": {\"parameters\": []}, \"MDTM\": {\"parameters\": []}, \"SIZE\": {\"parameters\": []}}, \"anonymous\": false, \"features_hash\": 566126305}, \"hash\": 1972528678, \"tags\": [\"starttls\", \"self-signed\"], \"timestamp\": \"2022-02-04T02:46:34.178244\", \"isp\": \"ecotel communication ag\", \"transport\": \"tcp\", \"data\": \"220 emmerich exclusivbrillen GmbH & Co. KG\r\n530 Login incorrect.\r\n530 Please login with USER and PASS.\r\n211-Features:\n AUTH TLS\n EPRT\n EPSV\n MDTM\n PASV\n PBSZ\n PROT\n REST STREAM\n SIZE\n TVFS\n211 End\r\n\", \"_shodan\": {\"crawler\": \"78039f81a0245caa8ab71c98182f0eff0ce52aab\", \"options\": {}, \"id\": \"e75e615b-5a53-42b1-bf89-eda33aa6a9c8\", \"module\": \"ftp\", \"ptr\": true}, \"port\": 21, \"ssl\": {\"chain_sha256\": [\"04e8e09743799aa7c0f978da8a26d00070e6692483a7477b328bdf449245e2df\"], \"jarm\": \"00000000000000000000000000000000000000000000000000000000000000\", \"chain\": [\"-----BEGIN CERTIFICATE-----\nMIIC+DCCAeCgAwIBAgIJAKf/2AHJeHDGMA0GCSqGSIb3DQEBCwUAMDQxMjAwBgNV\nBAMMKXV4bmxFbW1lcmljaC5lbW1lcmljaC1leGNsdXNpdmJyaWxsZW4uY29tMB4X\nDTE2MDgzMTA2NDMzNloXDTI2MDgyOTA2NDMzNlowNDEyMDAGA1UEAwwpdXhubEVt\nbWVyaWNoLmVtbWVyaWNoLWV4Y2x1c2l2YnJpbGxlbi5jb20wggEiMA0GCSqGSIb3\nDQEBAQUAA4IBDwAwggEKAoIBAQDNDJ0vsL7drYMDb4fcStKe7rAvaIQkwryoF5Ne\nQ4YvB8b+PPioF4lUzJx6e0CnjFxpbpLOKsyZ06/V7KXXIcH01h0LQgYHsIF/kkpt\nMwF/dQzShaDZoUA06mRvUDjn7I6qJXt9a8u/19PthDn8ceaKmY/p5WuQWpkMz+av\nKVEcwYAxsKaTY64piznPfDtzfxEmME0ZnrbOpmoWOEf1IB9ng7klGQ5nObjTOvoK\nBiA3kUR5E4iPWlI67N0ord11lescQrv4gSu3iVg9Dm2XF0MWw7xXrC7CdtA+BUxq\nBmzTno5NxyY6BIK+8NFBvm4nXUOeQx0mbLkbrKBqAr1Q3eDtAgMBAAGjDTALMAkG\nA1UdEwQCMAAwDQYJKoZIhvcNAQELBQADggEBAJEZg2tnBBYbtdsmgkmWDvxxsXcz\nQne4xqckwJLMdpMvdzOsY5E5gGUvyDgvqSN3OGuGljv3qJIGi4E+HhsSpyh9/yUg\nNQC+ZIpM0Dg362eT13kL3hLSEdZC0sZVuSju2L15BgYVWw1azUE40nK+c7WOsSsS\ncpTsBOKlpnUOh1CIa8q9o/DuPecbWU7rwjnmL5dxEvsNTSCzcsRfj48SeFGosPD1\nYhkrWep+hetgk9FX5AcO6Xyfk6XIhaP8UiLchvdspalJQG8L51uYcrzBEp9obz61\n0+WPUCe/Luii3WEFLtS64/NNWBjEoLOHVgoml66gY4r5/xxnW79W+tGND3o=\n-----END CERTIFICATE-----\n\"], \"dhparams\": null, \"versions\": [\"TLSv1\", \"-SSLv2\", \"-SSLv3\", \"TLSv1.1\", \"TLSv1.2\"], \"acceptable_cas\": [], \"tlsext\": [{\"id\": 65281, \"name\": \"renegotiation_info\"}, {\"id\": 35, \"name\": \"session_ticket\"}, {\"id\": 15, \"name\": \"heartbeat\"}], \"ja3s\": \"6d7cffc522e9a313f2786178efeef7cb\", \"cert\": {\"sig_alg\": \"sha256WithRSAEncryption\", \"issued\": \"20160831064336Z\", \"expires\": \"20260829064336Z\", \"expired\": false, \"version\": 2, \"extensions\": [{\"data\": \"0\x00\", \"name\": \"basicConstraints\"}], \"fingerprint\": {\"sha256\": \"04e8e09743799aa7c0f978da8a26d00070e6692483a7477b328bdf449245e2df\", \"sha1\": \"f4212825964b545928ee9210f88704cfda7fb835\"}, \"serial\": 12105631825581863110, \"subject\": {\"CN\": \"uxnlEmmerich.emmerich-exclusivbrillen.com\"}, \"pubkey\": {\"type\": \"rsa\", \"bits\": 2048}, \"issuer\": {\"CN\": \"uxnlEmmerich.emmerich-exclusivbrillen.com\"}}, \"cipher\": {\"version\": \"TLSv1/SSLv3\", \"bits\": 128, \"name\": \"AES128-SHA\"}, \"trust\": {\"revoked\": false, \"browser\": null}, \"handshake_states\": [], \"alpn\": [], \"ocsp\": {}}, \"hostnames\": [], \"location\": {\"city\": \"Frankfurt am Main\", \"region_code\": \"HE\", \"area_code\": null, \"longitude\": 8.68417, \"latitude\": 50.11552, \"country_code\": \"DE\", \"country_name\": \"Germany\"}, \"ip\": 1041894504, \"domains\": [], \"org\": \"NetLeaders GmbH & Co. KG\", \"os\": null, \"asn\": \"AS12312\", \"opts\": {}, \"ip_str\": \"62.26.12.104\"}, {\"ip\": 1041894504, \"port\": 22, \"transport\": \"tcp\", \"version\": \"6.7p1 Debian 5+deb8u8\", \"location\": {\"city\": \"Frankfurt am Main\", \"region_code\": \"HE\", \"area_code\": null, \"longitude\": 8.68417, \"latitude\": 50.11552, \"country_code\": \"DE\", \"country_name\": \"Germany\"}, \"product\": \"OpenSSH\", \"hash\": -738411401, \"timestamp\": \"2022-01-31T20:05:45.408407\", \"hostnames\": [], \"ssh\": {\"hassh\": \"3711ee816d3ea9975d96c39c31c54299\", \"fingerprint\": \"66:a6:35:8d:fd:59:82:3b:90:f8:2b:20:69:56:95:63\", \"mac\": \"hmac-sha2-256\", \"cipher\": \"aes128-ctr\", \"key\": \"AAAAB3NzaC1yc2EAAAADAQABAAABAQDirnvarokV/DbuYsuP/k0vp15ngFntq6Pu93TBu4u06DcA\nds4xsvoWjiH25dR40Hi63XjvxNy8PS9obzopAUBojsiqO3SQsJ6atQ7op6m6/W07a79sDZo04ec9\n5a1OcsXPZMNdHDUsQInVPZL0Fn6jQbrtpZKiFheBpEQr1N5r+4qgouU19GwIWUUqQJCtcMQpvuOg\nF1Dg8A+cu3tFdw4xai/OGsw3NxS9jOW5aLmbW1t01NSRaZXC4cLvdYDtZ/6RFKu4KR+3eHcSJGVg\n21xyzzaE0wTYCBMfblZxvldc4UjyNV2FMjAZfYS7EPlQ1XIOaMhcI5j31CA/MKjCMW6F\n\", \"kex\": {\"languages\": [\"\"], \"server_host_key_algorithms\": [\"ssh-rsa\", \"ssh-dss\", \"ecdsa-sha2-nistp256\", \"ssh-ed25519\"], \"encryption_algorithms\": [\"aes128-ctr\", \"aes192-ctr\", \"aes256-ctr\", \"aes128-gcm@openssh.com\", \"aes256-gcm@openssh.com\", \"chacha20-poly1305@openssh.com\"], \"kex_follows\": false, \"unused\": 0, \"kex_algorithms\": [\"curve25519-sha256@libssh.org\", \"ecdh-sha2-nistp256\", \"ecdh-sha2-nistp384\", \"ecdh-sha2-nistp521\", \"diffie-hellman-group-exchange-sha256\", \"diffie-hellman-group14-sha1\"], \"compression_algorithms\": [\"none\", \"zlib@openssh.com\"], \"mac_algorithms\": [\"umac-64-etm@openssh.com\", \"umac-128-etm@openssh.com\", \"hmac-sha2-256-etm@openssh.com\", \"hmac-sha2-512-etm@openssh.com\", \"hmac-sha1-etm@openssh.com\", \"umac-64@openssh.com\", \"umac-128@openssh.com\", \"hmac-sha2-256\", \"hmac-sha2-512\", \"hmac-sha1\"]}, \"type\": \"ssh-rsa\"}, \"org\": \"NetLeaders GmbH & Co. KG\", \"data\": \"SSH-2.0-OpenSSH_6.7p1 Debian-5+deb8u8\nKey type: ssh-rsa\nKey: AAAAB3NzaC1yc2EAAAADAQABAAABAQDirnvarokV/DbuYsuP/k0vp15ngFntq6Pu93TBu4u06DcA\nds4xsvoWjiH25dR40Hi63XjvxNy8PS9obzopAUBojsiqO3SQsJ6atQ7op6m6/W07a79sDZo04ec9\n5a1OcsXPZMNdHDUsQInVPZL0Fn6jQbrtpZKiFheBpEQr1N5r+4qgouU19GwIWUUqQJCtcMQpvuOg\nF1Dg8A+cu3tFdw4xai/OGsw3NxS9jOW5aLmbW1t01NSRaZXC4cLvdYDtZ/6RFKu4KR+3eHcSJGVg\n21xyzzaE0wTYCBMfblZxvldc4UjyNV2FMjAZfYS7EPlQ1XIOaMhcI5j31CA/MKjCMW6F\nFingerprint: 66:a6:35:8d:fd:59:82:3b:90:f8:2b:20:69:56:95:63\n\nKex Algorithms:\n\tcurve25519-sha256@libssh.org\n\tecdh-sha2-nistp256\n\tecdh-sha2-nistp384\n\tecdh-sha2-nistp521\n\tdiffie-hellman-group-exchange-sha256\n\tdiffie-hellman-group14-sha1\n\nServer Host Key Algorithms:\n\tssh-rsa\n\tssh-dss\n\tecdsa-sha2-nistp256\n\tssh-ed25519\n\nEncryption Algorithms:\n\taes128-ctr\n\taes192-ctr\n\taes256-ctr\n\taes128-gcm@openssh.com\n\taes256-gcm@openssh.com\n\tchacha20-poly1305@openssh.com\n\nMAC Algorithms:\n\tumac-64-etm@openssh.com\n\tumac-128-etm@openssh.com\n\thmac-sha2-256-etm@openssh.com\n\thmac-sha2-512-etm@openssh.com\n\thmac-sha1-etm@openssh.com\n\tumac-64@openssh.com\n\tumac-128@openssh.com\n\thmac-sha2-256\n\thmac-sha2-512\n\thmac-sha1\n\nCompression Algorithms:\n\tnone\n\tzlib@openssh.com\n\n\", \"asn\": \"AS12312\", \"cpe23\": [\"cpe:2.3:a:openbsd:openssh:6.7p1\", \"cpe:2.3:o:debian:debian_linux\", \"cpe:2.3:o:linux:linux_kernel\"], \"info\": \"protocol 2.0\", \"isp\": \"ecotel communication ag\", \"cpe\": [\"cpe:/a:openbsd:openssh:6.7p1\", \"cpe:/o:debian:debian_linux\", \"cpe:/o:linux:linux_kernel\"], \"domains\": [], \"ip_str\": \"62.26.12.104\", \"os\": null, \"_shodan\": {\"crawler\": \"487814a778c983e2dcef234806292d88c5cbf3ec\", \"options\": {}, \"id\": \"d428fcf1-e872-4216-a344-7a90e317f373\", \"module\": \"ssh\", \"ptr\": true}, \"opts\": {}}, {\"ip\": 1041894504, \"http\": {\"status\": 200, \"robots_hash\": null, \"redirects\": [], \"securitytxt\": null, \"title\": \"Default site\", \"sitemap_hash\": null, \"robots\": null, \"server\": \"Apache/2.4.10 (Debian)\", \"host\": \"62.26.12.104\", \"html\": \"<!DOCTYPE html>\n<html>\n\t<head>\n\t\t<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n\t\t<title>Default site</title>\n\t\t<style type=\"text/css\">\n\t\t\t#ph_image {\n\t\t\t\twidth:    100%;\n\t\t\t\theight:   100%;\n\t\t\t\tposition: absolute;\n\n\t\t\t\tbackground-image:    url('images/placeholder.gif');\n\t\t\t\tbackground-repeat:   no-repeat;\n\t\t\t\tbackground-position: center 30%;\n\t\t\t}\n\t\t</style>\n\t</head>\n\t<body>\n\t\t<div id=\"ph_image\"></div>\n\t</body>\n</html>\n\n\", \"location\": \"/\", \"components\": {}, \"html_hash\": 1043193832, \"sitemap\": null, \"securitytxt_hash\": null}, \"port\": 80, \"transport\": \"tcp\", \"version\": \"2.4.10\", \"location\": {\"city\": \"Frankfurt am Main\", \"region_code\": \"HE\", \"area_code\": null, \"longitude\": 8.68417, \"latitude\": 50.11552, \"country_code\": \"DE\", \"country_name\": \"Germany\"}, \"vulns\": {\"CVE-2014-8109\": {\"verified\": false, \"references\": [\"http://advisories.mageia.org/MGASA-2015-0011.html\", \"http://lists.apple.com/archives/security-announce/2015/Aug/msg00001.html\", \"http://lists.apple.com/archives/security-announce/2015/Sep/msg00004.html\", \"http://lists.fedoraproject.org/pipermail/package-announce/2015-June/159352.html\", \"http://www.openwall.com/lists/oss-security/2014/11/28/5\", \"http://www.oracle.com/technetwork/topics/security/cpujan2016-2367955.html\", \"http://www.securityfocus.com/bid/73040\", \"http://www.ubuntu.com/usn/USN-2523-1\", \"https://bugzilla.redhat.com/show_bug.cgi?id=1174077\", \"https://github.com/apache/httpd/commit/3f1693d558d0758f829c8b53993f1749ddf6ffcb\", \"https://issues.apache.org/bugzilla/show_bug.cgi?id=57204\", \"https://support.apple.com/HT205219\", \"https://support.apple.com/kb/HT205031\"], \"cvss\": 4.3, \"summary\": \"mod_lua.c in the mod_lua module in the Apache HTTP Server 2.3.x and 2.4.x through 2.4.10 does not support an httpd configuration in which the same Lua authorization provider is used with different arguments within different contexts, which allows remote attackers to bypass intended access restrictions in opportunistic circumstances by leveraging multiple Require directives, as demonstrated by a configuration that specifies authorization for one group to access a certain directory, and authorization for a second group to access a second directory.\"}, \"CVE-2015-3185\": {\"verified\": false, \"references\": [\"http://httpd.apache.org/security/vulnerabilities_24.html\", \"http://lists.apple.com/archives/security-announce/2015/Aug/msg00001.html\", \"http://lists.apple.com/archives/security-announce/2015/Sep/msg00002.html\", \"http://lists.apple.com/archives/security-announce/2015/Sep/msg00004.html\", \"http://lists.opensuse.org/opensuse-updates/2015-10/msg00011.html\", \"http://rhn.redhat.com/errata/RHSA-2015-1666.html\", \"http://rhn.redhat.com/errata/RHSA-2015-1667.html\", \"http://rhn.redhat.com/errata/RHSA-2016-2957.html\", \"http://www.apache.org/dist/httpd/CHANGES_2.4\", \"http://www.debian.org/security/2015/dsa-3325\", \"http://www.securityfocus.com/bid/75965\", \"http://www.securitytracker.com/id/1032967\", \"http://www.ubuntu.com/usn/USN-2686-1\", \"https://access.redhat.com/errata/RHSA-2017:2708\", \"https://access.redhat.com/errata/RHSA-2017:2709\", \"https://access.redhat.com/errata/RHSA-2017:2710\", \"https://github.com/apache/httpd/commit/cd2b7a26c776b0754fb98426a67804fd48118708\", \"https://support.apple.com/HT205217\", \"https://support.apple.com/HT205219\", \"https://support.apple.com/kb/HT205031\"], \"cvss\": 4.3, \"summary\": \"The ap_some_auth_required function in server/request.c in the Apache HTTP Server 2.4.x before 2.4.14 does not consider that a Require directive may be associated with an authorization setting rather than an authentication setting, which allows remote attackers to bypass intended access restrictions in opportunistic circumstances by leveraging the presence of a module that relies on the 2.2 API behavior.\"}, \"CVE-2016-8612\": {\"verified\": false, \"references\": [\"http://rhn.redhat.com/errata/RHSA-2016-2957.html\", \"http://www.securityfocus.com/bid/94939\", \"https://access.redhat.com/errata/RHSA-2017:0193\", \"https://access.redhat.com/errata/RHSA-2017:0194\", \"https://bugzilla.redhat.com/show_bug.cgi?id=1387605\", \"https://security.netapp.com/advisory/ntap-20180601-0005/\"], \"cvss\": \"3.3\", \"summary\": \"Apache HTTP Server mod_cluster before version httpd 2.4.23 is vulnerable to an Improper Input Validation in the protocol parsing logic in the load balancer resulting in a Segmentation Fault in the serving httpd process.\"}, \"CVE-2017-7679\": {\"verified\": false, \"references\": [\"http://www.debian.org/security/2017/dsa-3896\", \"http://www.oracle.com/technetwork/security-advisory/cpuoct2017-3236626.html\", \"http://www.securityfocus.com/bid/99170\", \"http://www.securitytracker.com/id/1038711\", \"https://access.redhat.com/errata/RHSA-2017:2478\", \"https://access.redhat.com/errata/RHSA-2017:2479\", \"https://access.redhat.com/errata/RHSA-2017:2483\", \"https://access.redhat.com/errata/RHSA-2017:3193\", \"https://access.redhat.com/errata/RHSA-2017:3194\", \"https://access.redhat.com/errata/RHSA-2017:3195\", \"https://access.redhat.com/errata/RHSA-2017:3475\", \"https://access.redhat.com/errata/RHSA-2017:3476\", \"https://access.redhat.com/errata/RHSA-2017:3477\", \"https://github.com/gottburgm/Exploits/tree/master/CVE-2017-7679\", \"https://lists.apache.org/thread.html/f4515e580dfb6eeca589a5cdebd4c4c709ce632b12924f343c3b7751@%3Cdev.httpd.apache.org%3E\", \"https://security.gentoo.org/glsa/201710-32\", \"https://security.netapp.com/advisory/ntap-20180601-0002/\", \"https://support.apple.com/HT208221\", \"https://support.hpe.com/hpsc/doc/public/display?docLocale=en_US&docId=emr_na-hpesbhf03821en_us\", \"https://support.hpe.com/hpsc/doc/public/display?docLocale=en_US&docId=emr_na-hpesbux03908en_us\", \"https://www.nomachine.com/SU08O00185\"], \"cvss\": \"7.5\", \"summary\": \"In Apache httpd 2.2.x before 2.2.33 and 2.4.x before 2.4.26, mod_mime can read one byte past the end of a buffer when sending a malicious Content-Type response header.\"}, \"CVE-2019-0220\": {\"verified\": false, \"references\": [\"http://lists.opensuse.org/opensuse-security-announce/2019-04/msg00051.html\", \"http://lists.opensuse.org/opensuse-security-announce/2019-04/msg00061.html\", \"http://lists.opensuse.org/opensuse-security-announce/2019-04/msg00084.html\", \"http://www.openwall.com/lists/oss-security/2019/04/02/6\", \"http://www.securityfocus.com/bid/107670\", \"https://httpd.apache.org/security/vulnerabilities_24.html\", \"https://lists.debian.org/debian-lts-announce/2019/04/msg00008.html\", \"https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ALIR5S3O7NRHEGFMIDMUSYQIZOE4TJJN/\", \"https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/EZRMTEIGZKYFNGIDOTXN3GNEJTLVCYU7/\", \"https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/WETXNQWNQLWHV6XNW6YTO5UGDTIWAQGT/\", \"https://seclists.org/bugtraq/2019/Apr/5\", \"https://security.netapp.com/advisory/ntap-20190625-0007/\", \"https://support.f5.com/csp/article/K44591505\", \"https://usn.ubuntu.com/3937-1/\", \"https://www.debian.org/security/2019/dsa-4422\"], \"cvss\": \"5.0\", \"summary\": \"A vulnerability was found in Apache HTTP Server 2.4.0 to 2.4.38. When the path component of a request URL contains multiple consecutive slashes ('/'), directives such as LocationMatch and RewriteRule must account for duplicates in regular expressions while other aspects of the servers processing will implicitly collapse them.\"}, \"CVE-2017-9788\": {\"verified\": false, \"references\": [\"http://www.debian.org/security/2017/dsa-3913\", \"http://www.oracle.com/technetwork/security-advisory/cpuoct2017-3236626.html\", \"http://www.securityfocus.com/bid/99569\", \"http://www.securitytracker.com/id/1038906\", \"https://access.redhat.com/errata/RHSA-2017:2478\", \"https://access.redhat.com/errata/RHSA-2017:2479\", \"https://access.redhat.com/errata/RHSA-2017:2483\", \"https://access.redhat.com/errata/RHSA-2017:2708\", \"https://access.redhat.com/errata/RHSA-2017:2709\", \"https://access.redhat.com/errata/RHSA-2017:2710\", \"https://access.redhat.com/errata/RHSA-2017:3113\", \"https://access.redhat.com/errata/RHSA-2017:3114\", \"https://access.redhat.com/errata/RHSA-2017:3193\", \"https://access.redhat.com/errata/RHSA-2017:3194\", \"https://access.redhat.com/errata/RHSA-2017:3195\", \"https://access.redhat.com/errata/RHSA-2017:3239\", \"https://access.redhat.com/errata/RHSA-2017:3240\", \"https://httpd.apache.org/security/vulnerabilities_22.html\", \"https://httpd.apache.org/security/vulnerabilities_24.html\", \"https://lists.apache.org/thread.html/0dd69204a6bd643cc4e9ccd008f07a9375525d977c6ebeb07a881afb@%3Cannounce.httpd.apache.org%3E\", \"https://lists.apache.org/thread.html/56c2e7cc9deb1c12a843d0dc251ea7fd3e7e80293cde02fcd65286ba@%3Ccvs.httpd.apache.org%3E\", \"https://security.gentoo.org/glsa/201710-32\", \"https://security.netapp.com/advisory/ntap-20170911-0002/\", \"https://support.apple.com/HT208221\", \"https://support.hpe.com/hpsc/doc/public/display?docLocale=en_US&docId=emr_na-hpesbux03908en_us\"], \"cvss\": \"6.4\", \"summary\": \"In Apache httpd before 2.2.34 and 2.4.x before 2.4.27, the value placeholder in [Proxy-]Authorization headers of type 'Digest' was not initialized or reset before or between successive key=value assignments by mod_auth_digest. Providing an initial key with no '=' assignment could reflect the stale value of uninitialized pool memory used by the prior request, leading to leakage of potentially confidential information, and a segfault in other cases resulting in denial of service.\"}, \"CVE-2016-0736\": {\"verified\": false, \"references\": [\"http://rhn.redhat.com/errata/RHSA-2017-1415.html\", \"http://www.debian.org/security/2017/dsa-3796\", \"http://www.securityfocus.com/bid/95078\", \"http://www.securitytracker.com/id/1037508\", \"https://access.redhat.com/errata/RHSA-2017:0906\", \"https://access.redhat.com/errata/RHSA-2017:1161\", \"https://access.redhat.com/errata/RHSA-2017:1413\", \"https://access.redhat.com/errata/RHSA-2017:1414\", \"https://h20566.www2.hpe.com/hpsc/doc/public/display?docLocale=en_US&docId=emr_na-hpesbux03725en_us\", \"https://httpd.apache.org/security/vulnerabilities_24.html#CVE-2016-0736\", \"https://security.gentoo.org/glsa/201701-36\", \"https://security.netapp.com/advisory/ntap-20180423-0001/\", \"https://support.apple.com/HT208221\", \"https://www.exploit-db.com/exploits/40961/\", \"https://www.tenable.com/security/tns-2017-04\"], \"cvss\": 5.0, \"summary\": \"In Apache HTTP Server versions 2.4.0 to 2.4.23, mod_session_crypto was encrypting its data/cookie using the configured ciphers with possibly either CBC or ECB modes of operation (AES256-CBC by default), hence no selectable or builtin authenticated encryption. This made it vulnerable to padding oracle attacks, particularly with CBC.\"}, \"CVE-2014-3583\": {\"verified\": false, \"references\": [\"http://httpd.apache.org/security/vulnerabilities_24.html\", \"http://lists.apple.com/archives/security-announce/2015/Aug/msg00001.html\", \"http://lists.apple.com/archives/security-announce/2015/Sep/msg00004.html\", \"http://rhn.redhat.com/errata/RHSA-2015-1855.html\", \"http://svn.apache.org/viewvc?view=revision&revision=1638818\", \"http://www.oracle.com/technetwork/topics/security/cpujan2016-2367955.html\", \"http://www.securityfocus.com/bid/71657\", \"http://www.ubuntu.com/usn/USN-2523-1\", \"https://access.redhat.com/errata/RHSA-2015:1858\", \"https://bugzilla.redhat.com/show_bug.cgi?id=1163555\", \"https://security.gentoo.org/glsa/201701-36\", \"https://support.apple.com/HT205219\", \"https://support.apple.com/kb/HT205031\"], \"cvss\": 5.0, \"summary\": \"The handle_headers function in mod_proxy_fcgi.c in the mod_proxy_fcgi module in the Apache HTTP Server 2.4.10 allows remote FastCGI servers to cause a denial of service (buffer over-read and daemon crash) via long response headers.\"}, \"CVE-2017-15710\": {\"verified\": false, \"references\": [\"http://www.openwall.com/lists/oss-security/2018/03/24/8\", \"http://www.securityfocus.com/bid/103512\", \"http://www.securitytracker.com/id/1040569\", \"https://access.redhat.com/errata/RHSA-2018:3558\", \"https://access.redhat.com/errata/RHSA-2019:0366\", \"https://access.redhat.com/errata/RHSA-2019:0367\", \"https://httpd.apache.org/security/vulnerabilities_24.html\", \"https://lists.apache.org/thread.html/56c2e7cc9deb1c12a843d0dc251ea7fd3e7e80293cde02fcd65286ba@%3Ccvs.httpd.apache.org%3E\", \"https://lists.debian.org/debian-lts-announce/2018/05/msg00020.html\", \"https://security.netapp.com/advisory/ntap-20180601-0004/\", \"https://support.hpe.com/hpsc/doc/public/display?docLocale=en_US&docId=emr_na-hpesbux03909en_us\", \"https://usn.ubuntu.com/3627-1/\", \"https://usn.ubuntu.com/3627-2/\", \"https://usn.ubuntu.com/3937-2/\", \"https://www.debian.org/security/2018/dsa-4164\"], \"cvss\": \"5.0\", \"summary\": \"In Apache httpd 2.0.23 to 2.0.65, 2.2.0 to 2.2.34, and 2.4.0 to 2.4.29, mod_authnz_ldap, if configured with AuthLDAPCharsetConfig, uses the Accept-Language header value to lookup the right charset encoding when verifying the user's credentials. If the header value is not present in the charset conversion table, a fallback mechanism is used to truncate it to a two characters value to allow a quick retry (for example, 'en-US' is truncated to 'en'). A header value of less than two characters forces an out of bound write of one NUL byte to a memory location that is not part of the string. In the worst case, quite unlikely, the process would crash which could be used as a Denial of Service attack. In the more likely case, this memory is already reserved for future use and the issue has no effect at all.\"}, \"CVE-2018-1283\": {\"verified\": false, \"references\": [\"http://www.openwall.com/lists/oss-security/2018/03/24/4\", \"http://www.securityfocus.com/bid/103520\", \"http://www.securitytracker.com/id/1040568\", \"https://access.redhat.com/errata/RHSA-2018:3558\", \"https://access.redhat.com/errata/RHSA-2019:0366\", \"https://access.redhat.com/errata/RHSA-2019:0367\", \"https://httpd.apache.org/security/vulnerabilities_24.html\", \"https://lists.apache.org/thread.html/56c2e7cc9deb1c12a843d0dc251ea7fd3e7e80293cde02fcd65286ba@%3Ccvs.httpd.apache.org%3E\", \"https://security.netapp.com/advisory/ntap-20180601-0004/\", \"https://support.hpe.com/hpsc/doc/public/display?docLocale=en_US&docId=emr_na-hpesbux03909en_us\", \"https://usn.ubuntu.com/3627-1/\", \"https://usn.ubuntu.com/3627-2/\", \"https://www.debian.org/security/2018/dsa-4164\"], \"cvss\": \"3.5\", \"summary\": \"In Apache httpd 2.4.0 to 2.4.29, when mod_session is configured to forward its session data to CGI applications (SessionEnv on, not the default), a remote user may influence their content by using a \"Session\" header. This comes from the \"HTTP_SESSION\" variable name used by mod_session to forward its data to CGIs, since the prefix \"HTTP_\" is also used by the Apache HTTP Server to pass HTTP header fields, per CGI specifications.\"}, \"CVE-2015-3184\": {\"verified\": false, \"references\": [\"http://lists.apple.com/archives/security-announce/2016/Mar/msg00003.html\", \"http://lists.opensuse.org/opensuse-updates/2015-08/msg00022.html\", \"http://rhn.redhat.com/errata/RHSA-2015-1742.html\", \"http://subversion.apache.org/security/CVE-2015-3184-advisory.txt\", \"http://www.debian.org/security/2015/dsa-3331\", \"http://www.securityfocus.com/bid/76274\", \"http://www.securitytracker.com/id/1033215\", \"http://www.ubuntu.com/usn/USN-2721-1\", \"https://security.gentoo.org/glsa/201610-05\", \"https://support.apple.com/HT206172\"], \"cvss\": 5.0, \"summary\": \"mod_authz_svn in Apache Subversion 1.7.x before 1.7.21 and 1.8.x before 1.8.14, when using Apache httpd 2.4.x, does not properly restrict anonymous access, which allows remote anonymous users to read hidden files via the path name.\"}, \"CVE-2017-3167\": {\"verified\": false, \"references\": [\"http://www.debian.org/security/2017/dsa-3896\", \"http://www.oracle.com/technetwork/security-advisory/cpuoct2017-3236626.html\", \"http://www.securityfocus.com/bid/99135\", \"http://www.securitytracker.com/id/1038711\", \"https://access.redhat.com/errata/RHSA-2017:2478\", \"https://access.redhat.com/errata/RHSA-2017:2479\", \"https://access.redhat.com/errata/RHSA-2017:2483\", \"https://access.redhat.com/errata/RHSA-2017:3193\", \"https://access.redhat.com/errata/RHSA-2017:3194\", \"https://access.redhat.com/errata/RHSA-2017:3195\", \"https://access.redhat.com/errata/RHSA-2017:3475\", \"https://access.redhat.com/errata/RHSA-2017:3476\", \"https://access.redhat.com/errata/RHSA-2017:3477\", \"https://lists.apache.org/thread.html/8409e41a8f7dd9ded37141c38df001be930115428c3d64f70bbdb8b4@%3Cdev.httpd.apache.org%3E\", \"https://security.gentoo.org/glsa/201710-32\", \"https://security.netapp.com/advisory/ntap-20180601-0002/\", \"https://support.apple.com/HT208221\", \"https://support.hpe.com/hpsc/doc/public/display?docLocale=en_US&docId=emr_na-hpesbux03908en_us\", \"https://www.nomachine.com/SU08O00185\"], \"cvss\": \"7.5\", \"summary\": \"In Apache httpd 2.2.x before 2.2.33 and 2.4.x before 2.4.26, use of the ap_get_basic_auth_pw() by third-party modules outside of the authentication phase may lead to authentication requirements being bypassed.\"}, \"CVE-2017-9798\": {\"verified\": false, \"references\": [\"http://openwall.com/lists/oss-security/2017/09/18/2\", \"http://www.debian.org/security/2017/dsa-3980\", \"http://www.oracle.com/technetwork/security-advisory/cpuapr2018-3678067.html\", \"http://www.oracle.com/technetwork/security-advisory/cpujan2018-3236628.html\", \"http://www.oracle.com/technetwork/security-advisory/cpujul2018-4258247.html\", \"http://www.oracle.com/technetwork/security-advisory/cpuoct2018-4428296.html\", \"http://www.securityfocus.com/bid/100872\", \"http://www.securityfocus.com/bid/105598\", \"http://www.securitytracker.com/id/1039387\", \"https://access.redhat.com/errata/RHSA-2017:2882\", \"https://access.redhat.com/errata/RHSA-2017:2972\", \"https://access.redhat.com/errata/RHSA-2017:3018\", \"https://access.redhat.com/errata/RHSA-2017:3113\", \"https://access.redhat.com/errata/RHSA-2017:3114\", \"https://access.redhat.com/errata/RHSA-2017:3193\", \"https://access.redhat.com/errata/RHSA-2017:3194\", \"https://access.redhat.com/errata/RHSA-2017:3195\", \"https://access.redhat.com/errata/RHSA-2017:3239\", \"https://access.redhat.com/errata/RHSA-2017:3240\", \"https://access.redhat.com/errata/RHSA-2017:3475\", \"https://access.redhat.com/errata/RHSA-2017:3476\", \"https://access.redhat.com/errata/RHSA-2017:3477\", \"https://blog.fuzzing-project.org/60-Optionsbleed-HTTP-OPTIONS-method-can-leak-Apaches-server-memory.html\", \"https://blog.fuzzing-project.org/uploads/apache-2.2-optionsbleed-backport.patch\", \"https://github.com/apache/httpd/commit/29afdd2550b3d30a8defece2b95ae81edcf66ac9\", \"https://github.com/hannob/optionsbleed\", \"https://httpd.apache.org/security/vulnerabilities_24.html#CVE-2017-9798\", \"https://security-tracker.debian.org/tracker/CVE-2017-9798\", \"https://security.gentoo.org/glsa/201710-32\", \"https://security.netapp.com/advisory/ntap-20180601-0003/\", \"https://support.apple.com/HT208331\", \"https://support.hpe.com/hpsc/doc/public/display?docLocale=en_US&docId=emr_na-hpesbux03909en_us\", \"https://svn.apache.org/viewvc/httpd/httpd/branches/2.4.x/server/core.c?r1=1805223&r2=1807754&pathrev=1807754&view=patch\", \"https://www.exploit-db.com/exploits/42745/\", \"https://www.oracle.com/technetwork/security-advisory/cpuapr2019-5072813.html\", \"https://www.oracle.com/technetwork/security-advisory/cpujan2019-5072801.html\"], \"cvss\": \"5.0\", \"summary\": \"Apache httpd allows remote attackers to read secret data from process memory if the Limit directive can be set in a user's .htaccess file, or if httpd.conf has certain misconfigurations, aka Optionsbleed. This affects the Apache HTTP Server through 2.2.34 and 2.4.x through 2.4.27. The attacker sends an unauthenticated OPTIONS HTTP request when attempting to read secret data. This is a use-after-free issue and thus secret data is not always sent, and the specific data depends on many factors including configuration. Exploitation with .htaccess can be blocked with a patch to the ap_limit_section function in server/core.c.\"}, \"CVE-2016-8743\": {\"verified\": false, \"references\": [\"http://rhn.redhat.com/errata/RHSA-2017-1415.html\", \"http://www.debian.org/security/2017/dsa-3796\", \"http://www.securityfocus.com/bid/95077\", \"http://www.securitytracker.com/id/1037508\", \"https://access.redhat.com/errata/RHSA-2017:0906\", \"https://access.redhat.com/errata/RHSA-2017:1161\", \"https://access.redhat.com/errata/RHSA-2017:1413\", \"https://access.redhat.com/errata/RHSA-2017:1414\", \"https://access.redhat.com/errata/RHSA-2017:1721\", \"https://h20566.www2.hpe.com/hpsc/doc/public/display?docLocale=en_US&docId=emr_na-hpesbmu03753en_us\", \"https://h20566.www2.hpe.com/hpsc/doc/public/display?docLocale=en_US&docId=emr_na-hpesbux03725en_us\", \"https://httpd.apache.org/security/vulnerabilities_24.html#CVE-2016-8743\", \"https://security.gentoo.org/glsa/201701-36\", \"https://security.netapp.com/advisory/ntap-20180423-0001/\", \"https://support.apple.com/HT208221\", \"https://www.tenable.com/security/tns-2017-04\"], \"cvss\": 5.0, \"summary\": \"Apache HTTP Server, in all releases prior to 2.2.32 and 2.4.25, was liberal in the whitespace accepted from requests and sent in response lines and headers. Accepting these different behaviors represented a security concern when httpd participates in any chain of proxies or interacts with back-end application servers, either through mod_proxy or using conventional CGI mechanisms, and may result in request smuggling, response splitting and cache pollution.\"}, \"CVE-2017-15715\": {\"verified\": false, \"references\": [\"http://www.openwall.com/lists/oss-security/2018/03/24/6\", \"http://www.securityfocus.com/bid/103525\", \"http://www.securitytracker.com/id/1040570\", \"https://access.redhat.com/errata/RHSA-2018:3558\", \"https://access.redhat.com/errata/RHSA-2019:0366\", \"https://access.redhat.com/errata/RHSA-2019:0367\", \"https://httpd.apache.org/security/vulnerabilities_24.html\", \"https://lists.apache.org/thread.html/56c2e7cc9deb1c12a843d0dc251ea7fd3e7e80293cde02fcd65286ba@%3Ccvs.httpd.apache.org%3E\", \"https://security.netapp.com/advisory/ntap-20180601-0004/\", \"https://support.hpe.com/hpsc/doc/public/display?docLocale=en_US&docId=emr_na-hpesbux03909en_us\", \"https://usn.ubuntu.com/3627-1/\", \"https://usn.ubuntu.com/3627-2/\", \"https://www.debian.org/security/2018/dsa-4164\"], \"cvss\": \"6.8\", \"summary\": \"In Apache httpd 2.4.0 to 2.4.29, the expression specified in <FilesMatch> could match '$' to a newline character in a malicious filename, rather than matching only the end of the filename. This could be exploited in environments where uploads of some files are are externally blocked, but only by matching the trailing portion of the filename.\"}, \"CVE-2017-7668\": {\"verified\": false, \"references\": [\"http://www.debian.org/security/2017/dsa-3896\", \"http://www.oracle.com/technetwork/security-advisory/cpuoct2017-3236626.html\", \"http://www.securityfocus.com/bid/99137\", \"http://www.securitytracker.com/id/1038711\", \"https://access.redhat.com/errata/RHSA-2017:2479\", \"https://access.redhat.com/errata/RHSA-2017:2483\", \"https://access.redhat.com/errata/RHSA-2017:3193\", \"https://access.redhat.com/errata/RHSA-2017:3194\", \"https://lists.apache.org/thread.html/55a068b6a5eec0b3198ae7d96a7cb412352d0ffa7716612c5af3745b@%3Cdev.httpd.apache.org%3E\", \"https://security.gentoo.org/glsa/201710-32\", \"https://security.netapp.com/advisory/ntap-20180601-0002/\", \"https://support.apple.com/HT208221\", \"https://support.hpe.com/hpsc/doc/public/display?docLocale=en_US&docId=emr_na-hpesbhf03821en_us\", \"https://support.hpe.com/hpsc/doc/public/display?docLocale=en_US&docId=emr_na-hpesbux03908en_us\"], \"cvss\": \"7.5\", \"summary\": \"The HTTP strict parsing changes added in Apache httpd 2.2.32 and 2.4.24 introduced a bug in token list parsing, which allows ap_find_token() to search past the end of its input string. By maliciously crafting a sequence of request headers, an attacker may be able to cause a segmentation fault, or to force ap_find_token() to return an incorrect value.\"}, \"CVE-2017-3169\": {\"verified\": false, \"references\": [\"http://www.debian.org/security/2017/dsa-3896\", \"http://www.oracle.com/technetwork/security-advisory/cpuoct2017-3236626.html\", \"http://www.securityfocus.com/bid/99134\", \"http://www.securitytracker.com/id/1038711\", \"https://access.redhat.com/errata/RHSA-2017:2478\", \"https://access.redhat.com/errata/RHSA-2017:2479\", \"https://access.redhat.com/errata/RHSA-2017:2483\", \"https://access.redhat.com/errata/RHSA-2017:3193\", \"https://access.redhat.com/errata/RHSA-2017:3194\", \"https://access.redhat.com/errata/RHSA-2017:3195\", \"https://access.redhat.com/errata/RHSA-2017:3475\", \"https://access.redhat.com/errata/RHSA-2017:3476\", \"https://access.redhat.com/errata/RHSA-2017:3477\", \"https://github.com/gottburgm/Exploits/tree/master/CVE-2017-3169\", \"https://lists.apache.org/thread.html/84bf7fcc5cad35d355f11839cbdd13cbc5ffc1d34675090bff0f96ae@%3Cdev.httpd.apache.org%3E\", \"https://security.gentoo.org/glsa/201710-32\", \"https://security.netapp.com/advisory/ntap-20180601-0002/\", \"https://support.apple.com/HT208221\", \"https://support.hpe.com/hpsc/doc/public/display?docLocale=en_US&docId=emr_na-hpesbux03908en_us\", \"https://www.nomachine.com/SU08O00185\"], \"cvss\": \"7.5\", \"summary\": \"In Apache httpd 2.2.x before 2.2.33 and 2.4.x before 2.4.26, mod_ssl may dereference a NULL pointer when third-party modules call ap_hook_process_connection() during an HTTP request to an HTTPS port.\"}, \"CVE-2016-4975\": {\"verified\": false, \"references\": [\"http://www.securityfocus.com/bid/105093\", \"https://httpd.apache.org/security/vulnerabilities_22.html#CVE-2016-4975\", \"https://httpd.apache.org/security/vulnerabilities_24.html#CVE-2016-4975\", \"https://security.netapp.com/advisory/ntap-20180926-0006/\", \"https://support.hpe.com/hpsc/doc/public/display?docLocale=en_US&docId=emr_na-hpesbux03908en_us\"], \"cvss\": \"4.3\", \"summary\": \"Possible CRLF injection allowing HTTP response splitting attacks for sites which use mod_userdir. This issue was mitigated by changes made in 2.4.25 and 2.2.32 which prohibit CR or LF injection into the \"Location\" or other outbound header key or value. Fixed in Apache HTTP Server 2.4.25 (Affected 2.4.1-2.4.23). Fixed in Apache HTTP Server 2.2.32 (Affected 2.2.0-2.2.31).\"}, \"CVE-2018-17199\": {\"verified\": false, \"references\": [\"http://www.securityfocus.com/bid/106742\", \"https://httpd.apache.org/security/vulnerabilities_24.html\", \"https://lists.debian.org/debian-lts-announce/2019/01/msg00024.html\", \"https://seclists.org/bugtraq/2019/Apr/5\", \"https://security.gentoo.org/glsa/201903-21\", \"https://security.netapp.com/advisory/ntap-20190125-0001/\", \"https://usn.ubuntu.com/3937-1/\", \"https://www.debian.org/security/2019/dsa-4422\", \"https://www.oracle.com/technetwork/security-advisory/cpuapr2019-5072813.html\", \"https://www.oracle.com/technetwork/security-advisory/cpujul2019-5072835.html\"], \"cvss\": \"5.0\", \"summary\": \"In Apache HTTP Server 2.4 release 2.4.37 and prior, mod_session checks the session expiry time before decoding the session. This causes session expiry time to be ignored for mod_session_cookie sessions since the expiry time is loaded when the session is decoded.\"}, \"CVE-2016-2161\": {\"verified\": false, \"references\": [\"http://rhn.redhat.com/errata/RHSA-2017-1415.html\", \"http://www.debian.org/security/2017/dsa-3796\", \"http://www.securityfocus.com/bid/95076\", \"http://www.securitytracker.com/id/1037508\", \"https://access.redhat.com/errata/RHSA-2017:0906\", \"https://access.redhat.com/errata/RHSA-2017:1161\", \"https://access.redhat.com/errata/RHSA-2017:1413\", \"https://access.redhat.com/errata/RHSA-2017:1414\", \"https://h20566.www2.hpe.com/hpsc/doc/public/display?docLocale=en_US&docId=emr_na-hpesbux03725en_us\", \"https://httpd.apache.org/security/vulnerabilities_24.html#CVE-2016-2161\", \"https://security.gentoo.org/glsa/201701-36\", \"https://security.netapp.com/advisory/ntap-20180423-0001/\", \"https://support.apple.com/HT208221\", \"https://www.tenable.com/security/tns-2017-04\"], \"cvss\": 5.0, \"summary\": \"In Apache HTTP Server versions 2.4.0 to 2.4.23, malicious input to mod_auth_digest can cause the server to crash, and each instance continues to crash even for subsequently valid requests.\"}, \"CVE-2018-1312\": {\"verified\": false, \"references\": [\"http://www.openwall.com/lists/oss-security/2018/03/24/7\", \"http://www.securityfocus.com/bid/103524\", \"http://www.securitytracker.com/id/1040571\", \"https://access.redhat.com/errata/RHSA-2018:3558\", \"https://access.redhat.com/errata/RHSA-2019:0366\", \"https://access.redhat.com/errata/RHSA-2019:0367\", \"https://access.redhat.com/errata/RHSA-2019:1898\", \"https://httpd.apache.org/security/vulnerabilities_24.html\", \"https://lists.debian.org/debian-lts-announce/2018/05/msg00020.html\", \"https://security.netapp.com/advisory/ntap-20180601-0004/\", \"https://support.hpe.com/hpsc/doc/public/display?docLocale=en_US&docId=emr_na-hpesbux03909en_us\", \"https://usn.ubuntu.com/3627-1/\", \"https://usn.ubuntu.com/3627-2/\", \"https://usn.ubuntu.com/3937-2/\", \"https://www.debian.org/security/2018/dsa-4164\"], \"cvss\": \"6.8\", \"summary\": \"In Apache httpd 2.2.0 to 2.4.29, when generating an HTTP Digest authentication challenge, the nonce sent to prevent reply attacks was not correctly generated using a pseudo-random seed. In a cluster of servers using a common Digest authentication configuration, HTTP requests could be replayed across servers by an attacker without detection.\"}}, \"product\": \"Apache httpd\", \"hash\": 1984017837, \"timestamp\": \"2022-02-02T14:37:50.414771\", \"hostnames\": [], \"org\": \"NetLeaders GmbH & Co. KG\", \"data\": \"HTTP/1.1 200 OK\r\nDate: Wed, 02 Feb 2022 14:37:49 GMT\r\nServer: Apache/2.4.10 (Debian)\r\nLast-Modified: Wed, 31 Aug 2016 06:48:14 GMT\r\nETag: \"1bd-53b587b46b76d\"\r\nAccept-Ranges: bytes\r\nContent-Length: 445\r\nVary: Accept-Encoding\r\nContent-Type: text/html\r\n\r\n\", \"asn\": \"AS12312\", \"cpe23\": [\"cpe:2.3:a:apache:http_server:2.4.10\"], \"info\": \"(Debian)\", \"isp\": \"ecotel communication ag\", \"cpe\": [\"cpe:/a:apache:http_server:2.4.10\"], \"domains\": [], \"ip_str\": \"62.26.12.104\", \"os\": null, \"_shodan\": {\"crawler\": \"6f55d367cbfc8dfe8f206264b1aea3853dd5b496\", \"options\": {}, \"id\": \"a9087869-9a76-4e8c-bbc1-1b95deb1a9c0\", \"module\": \"http\", \"ptr\": true}, \"opts\": {}}, {\"vulns\": {\"CVE-2014-8109\": {\"verified\": false, \"references\": [\"http://advisories.mageia.org/MGASA-2015-0011.html\", \"http://lists.apple.com/archives/security-announce/2015/Aug/msg00001.html\", \"http://lists.apple.com/archives/security-announce/2015/Sep/msg00004.html\", \"http://lists.fedoraproject.org/pipermail/package-announce/2015-June/159352.html\", \"http://www.openwall.com/lists/oss-security/2014/11/28/5\", \"http://www.oracle.com/technetwork/topics/security/cpujan2016-2367955.html\", \"http://www.securityfocus.com/bid/73040\", \"http://www.ubuntu.com/usn/USN-2523-1\", \"https://bugzilla.redhat.com/show_bug.cgi?id=1174077\", \"https://github.com/apache/httpd/commit/3f1693d558d0758f829c8b53993f1749ddf6ffcb\", \"https://issues.apache.org/bugzilla/show_bug.cgi?id=57204\", \"https://support.apple.com/HT205219\", \"https://support.apple.com/kb/HT205031\"], \"cvss\": 4.3, \"summary\": \"mod_lua.c in the mod_lua module in the Apache HTTP Server 2.3.x and 2.4.x through 2.4.10 does not support an httpd configuration in which the same Lua authorization provider is used with different arguments within different contexts, which allows remote attackers to bypass intended access restrictions in opportunistic circumstances by leveraging multiple Require directives, as demonstrated by a configuration that specifies authorization for one group to access a certain directory, and authorization for a second group to access a second directory.\"}, \"CVE-2015-3185\": {\"verified\": false, \"references\": [\"http://httpd.apache.org/security/vulnerabilities_24.html\", \"http://lists.apple.com/archives/security-announce/2015/Aug/msg00001.html\", \"http://lists.apple.com/archives/security-announce/2015/Sep/msg00002.html\", \"http://lists.apple.com/archives/security-announce/2015/Sep/msg00004.html\", \"http://lists.opensuse.org/opensuse-updates/2015-10/msg00011.html\", \"http://rhn.redhat.com/errata/RHSA-2015-1666.html\", \"http://rhn.redhat.com/errata/RHSA-2015-1667.html\", \"http://rhn.redhat.com/errata/RHSA-2016-2957.html\", \"http://www.apache.org/dist/httpd/CHANGES_2.4\", \"http://www.debian.org/security/2015/dsa-3325\", \"http://www.securityfocus.com/bid/75965\", \"http://www.securitytracker.com/id/1032967\", \"http://www.ubuntu.com/usn/USN-2686-1\", \"https://access.redhat.com/errata/RHSA-2017:2708\", \"https://access.redhat.com/errata/RHSA-2017:2709\", \"https://access.redhat.com/errata/RHSA-2017:2710\", \"https://github.com/apache/httpd/commit/cd2b7a26c776b0754fb98426a67804fd48118708\", \"https://support.apple.com/HT205217\", \"https://support.apple.com/HT205219\", \"https://support.apple.com/kb/HT205031\"], \"cvss\": 4.3, \"summary\": \"The ap_some_auth_required function in server/request.c in the Apache HTTP Server 2.4.x before 2.4.14 does not consider that a Require directive may be associated with an authorization setting rather than an authentication setting, which allows remote attackers to bypass intended access restrictions in opportunistic circumstances by leveraging the presence of a module that relies on the 2.2 API behavior.\"}, \"CVE-2016-8612\": {\"verified\": false, \"references\": [\"http://rhn.redhat.com/errata/RHSA-2016-2957.html\", \"http://www.securityfocus.com/bid/94939\", \"https://access.redhat.com/errata/RHSA-2017:0193\", \"https://access.redhat.com/errata/RHSA-2017:0194\", \"https://bugzilla.redhat.com/show_bug.cgi?id=1387605\", \"https://security.netapp.com/advisory/ntap-20180601-0005/\"], \"cvss\": \"3.3\", \"summary\": \"Apache HTTP Server mod_cluster before version httpd 2.4.23 is vulnerable to an Improper Input Validation in the protocol parsing logic in the load balancer resulting in a Segmentation Fault in the serving httpd process.\"}, \"CVE-2017-7679\": {\"verified\": false, \"references\": [\"http://www.debian.org/security/2017/dsa-3896\", \"http://www.oracle.com/technetwork/security-advisory/cpuoct2017-3236626.html\", \"http://www.securityfocus.com/bid/99170\", \"http://www.securitytracker.com/id/1038711\", \"https://access.redhat.com/errata/RHSA-2017:2478\", \"https://access.redhat.com/errata/RHSA-2017:2479\", \"https://access.redhat.com/errata/RHSA-2017:2483\", \"https://access.redhat.com/errata/RHSA-2017:3193\", \"https://access.redhat.com/errata/RHSA-2017:3194\", \"https://access.redhat.com/errata/RHSA-2017:3195\", \"https://access.redhat.com/errata/RHSA-2017:3475\", \"https://access.redhat.com/errata/RHSA-2017:3476\", \"https://access.redhat.com/errata/RHSA-2017:3477\", \"https://github.com/gottburgm/Exploits/tree/master/CVE-2017-7679\", \"https://lists.apache.org/thread.html/f4515e580dfb6eeca589a5cdebd4c4c709ce632b12924f343c3b7751@%3Cdev.httpd.apache.org%3E\", \"https://security.gentoo.org/glsa/201710-32\", \"https://security.netapp.com/advisory/ntap-20180601-0002/\", \"https://support.apple.com/HT208221\", \"https://support.hpe.com/hpsc/doc/public/display?docLocale=en_US&docId=emr_na-hpesbhf03821en_us\", \"https://support.hpe.com/hpsc/doc/public/display?docLocale=en_US&docId=emr_na-hpesbux03908en_us\", \"https://www.nomachine.com/SU08O00185\"], \"cvss\": \"7.5\", \"summary\": \"In Apache httpd 2.2.x before 2.2.33 and 2.4.x before 2.4.26, mod_mime can read one byte past the end of a buffer when sending a malicious Content-Type response header.\"}, \"CVE-2019-0220\": {\"verified\": false, \"references\": [\"http://lists.opensuse.org/opensuse-security-announce/2019-04/msg00051.html\", \"http://lists.opensuse.org/opensuse-security-announce/2019-04/msg00061.html\", \"http://lists.opensuse.org/opensuse-security-announce/2019-04/msg00084.html\", \"http://www.openwall.com/lists/oss-security/2019/04/02/6\", \"http://www.securityfocus.com/bid/107670\", \"https://httpd.apache.org/security/vulnerabilities_24.html\", \"https://lists.debian.org/debian-lts-announce/2019/04/msg00008.html\", \"https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ALIR5S3O7NRHEGFMIDMUSYQIZOE4TJJN/\", \"https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/EZRMTEIGZKYFNGIDOTXN3GNEJTLVCYU7/\", \"https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/WETXNQWNQLWHV6XNW6YTO5UGDTIWAQGT/\", \"https://seclists.org/bugtraq/2019/Apr/5\", \"https://security.netapp.com/advisory/ntap-20190625-0007/\", \"https://support.f5.com/csp/article/K44591505\", \"https://usn.ubuntu.com/3937-1/\", \"https://www.debian.org/security/2019/dsa-4422\"], \"cvss\": \"5.0\", \"summary\": \"A vulnerability was found in Apache HTTP Server 2.4.0 to 2.4.38. When the path component of a request URL contains multiple consecutive slashes ('/'), directives such as LocationMatch and RewriteRule must account for duplicates in regular expressions while other aspects of the servers processing will implicitly collapse them.\"}, \"CVE-2017-9788\": {\"verified\": false, \"references\": [\"http://www.debian.org/security/2017/dsa-3913\", \"http://www.oracle.com/technetwork/security-advisory/cpuoct2017-3236626.html\", \"http://www.securityfocus.com/bid/99569\", \"http://www.securitytracker.com/id/1038906\", \"https://access.redhat.com/errata/RHSA-2017:2478\", \"https://access.redhat.com/errata/RHSA-2017:2479\", \"https://access.redhat.com/errata/RHSA-2017:2483\", \"https://access.redhat.com/errata/RHSA-2017:2708\", \"https://access.redhat.com/errata/RHSA-2017:2709\", \"https://access.redhat.com/errata/RHSA-2017:2710\", \"https://access.redhat.com/errata/RHSA-2017:3113\", \"https://access.redhat.com/errata/RHSA-2017:3114\", \"https://access.redhat.com/errata/RHSA-2017:3193\", \"https://access.redhat.com/errata/RHSA-2017:3194\", \"https://access.redhat.com/errata/RHSA-2017:3195\", \"https://access.redhat.com/errata/RHSA-2017:3239\", \"https://access.redhat.com/errata/RHSA-2017:3240\", \"https://httpd.apache.org/security/vulnerabilities_22.html\", \"https://httpd.apache.org/security/vulnerabilities_24.html\", \"https://lists.apache.org/thread.html/0dd69204a6bd643cc4e9ccd008f07a9375525d977c6ebeb07a881afb@%3Cannounce.httpd.apache.org%3E\", \"https://lists.apache.org/thread.html/56c2e7cc9deb1c12a843d0dc251ea7fd3e7e80293cde02fcd65286ba@%3Ccvs.httpd.apache.org%3E\", \"https://security.gentoo.org/glsa/201710-32\", \"https://security.netapp.com/advisory/ntap-20170911-0002/\", \"https://support.apple.com/HT208221\", \"https://support.hpe.com/hpsc/doc/public/display?docLocale=en_US&docId=emr_na-hpesbux03908en_us\"], \"cvss\": \"6.4\", \"summary\": \"In Apache httpd before 2.2.34 and 2.4.x before 2.4.27, the value placeholder in [Proxy-]Authorization headers of type 'Digest' was not initialized or reset before or between successive key=value assignments by mod_auth_digest. Providing an initial key with no '=' assignment could reflect the stale value of uninitialized pool memory used by the prior request, leading to leakage of potentially confidential information, and a segfault in other cases resulting in denial of service.\"}, \"CVE-2016-0736\": {\"verified\": false, \"references\": [\"http://rhn.redhat.com/errata/RHSA-2017-1415.html\", \"http://www.debian.org/security/2017/dsa-3796\", \"http://www.securityfocus.com/bid/95078\", \"http://www.securitytracker.com/id/1037508\", \"https://access.redhat.com/errata/RHSA-2017:0906\", \"https://access.redhat.com/errata/RHSA-2017:1161\", \"https://access.redhat.com/errata/RHSA-2017:1413\", \"https://access.redhat.com/errata/RHSA-2017:1414\", \"https://h20566.www2.hpe.com/hpsc/doc/public/display?docLocale=en_US&docId=emr_na-hpesbux03725en_us\", \"https://httpd.apache.org/security/vulnerabilities_24.html#CVE-2016-0736\", \"https://security.gentoo.org/glsa/201701-36\", \"https://security.netapp.com/advisory/ntap-20180423-0001/\", \"https://support.apple.com/HT208221\", \"https://www.exploit-db.com/exploits/40961/\", \"https://www.tenable.com/security/tns-2017-04\"], \"cvss\": 5.0, \"summary\": \"In Apache HTTP Server versions 2.4.0 to 2.4.23, mod_session_crypto was encrypting its data/cookie using the configured ciphers with possibly either CBC or ECB modes of operation (AES256-CBC by default), hence no selectable or builtin authenticated encryption. This made it vulnerable to padding oracle attacks, particularly with CBC.\"}, \"CVE-2014-3583\": {\"verified\": false, \"references\": [\"http://httpd.apache.org/security/vulnerabilities_24.html\", \"http://lists.apple.com/archives/security-announce/2015/Aug/msg00001.html\", \"http://lists.apple.com/archives/security-announce/2015/Sep/msg00004.html\", \"http://rhn.redhat.com/errata/RHSA-2015-1855.html\", \"http://svn.apache.org/viewvc?view=revision&revision=1638818\", \"http://www.oracle.com/technetwork/topics/security/cpujan2016-2367955.html\", \"http://www.securityfocus.com/bid/71657\", \"http://www.ubuntu.com/usn/USN-2523-1\", \"https://access.redhat.com/errata/RHSA-2015:1858\", \"https://bugzilla.redhat.com/show_bug.cgi?id=1163555\", \"https://security.gentoo.org/glsa/201701-36\", \"https://support.apple.com/HT205219\", \"https://support.apple.com/kb/HT205031\"], \"cvss\": 5.0, \"summary\": \"The handle_headers function in mod_proxy_fcgi.c in the mod_proxy_fcgi module in the Apache HTTP Server 2.4.10 allows remote FastCGI servers to cause a denial of service (buffer over-read and daemon crash) via long response headers.\"}, \"CVE-2017-15710\": {\"verified\": false, \"references\": [\"http://www.openwall.com/lists/oss-security/2018/03/24/8\", \"http://www.securityfocus.com/bid/103512\", \"http://www.securitytracker.com/id/1040569\", \"https://access.redhat.com/errata/RHSA-2018:3558\", \"https://access.redhat.com/errata/RHSA-2019:0366\", \"https://access.redhat.com/errata/RHSA-2019:0367\", \"https://httpd.apache.org/security/vulnerabilities_24.html\", \"https://lists.apache.org/thread.html/56c2e7cc9deb1c12a843d0dc251ea7fd3e7e80293cde02fcd65286ba@%3Ccvs.httpd.apache.org%3E\", \"https://lists.debian.org/debian-lts-announce/2018/05/msg00020.html\", \"https://security.netapp.com/advisory/ntap-20180601-0004/\", \"https://support.hpe.com/hpsc/doc/public/display?docLocale=en_US&docId=emr_na-hpesbux03909en_us\", \"https://usn.ubuntu.com/3627-1/\", \"https://usn.ubuntu.com/3627-2/\", \"https://usn.ubuntu.com/3937-2/\", \"https://www.debian.org/security/2018/dsa-4164\"], \"cvss\": \"5.0\", \"summary\": \"In Apache httpd 2.0.23 to 2.0.65, 2.2.0 to 2.2.34, and 2.4.0 to 2.4.29, mod_authnz_ldap, if configured with AuthLDAPCharsetConfig, uses the Accept-Language header value to lookup the right charset encoding when verifying the user's credentials. If the header value is not present in the charset conversion table, a fallback mechanism is used to truncate it to a two characters value to allow a quick retry (for example, 'en-US' is truncated to 'en'). A header value of less than two characters forces an out of bound write of one NUL byte to a memory location that is not part of the string. In the worst case, quite unlikely, the process would crash which could be used as a Denial of Service attack. In the more likely case, this memory is already reserved for future use and the issue has no effect at all.\"}, \"CVE-2018-1283\": {\"verified\": false, \"references\": [\"http://www.openwall.com/lists/oss-security/2018/03/24/4\", \"http://www.securityfocus.com/bid/103520\", \"http://www.securitytracker.com/id/1040568\", \"https://access.redhat.com/errata/RHSA-2018:3558\", \"https://access.redhat.com/errata/RHSA-2019:0366\", \"https://access.redhat.com/errata/RHSA-2019:0367\", \"https://httpd.apache.org/security/vulnerabilities_24.html\", \"https://lists.apache.org/thread.html/56c2e7cc9deb1c12a843d0dc251ea7fd3e7e80293cde02fcd65286ba@%3Ccvs.httpd.apache.org%3E\", \"https://security.netapp.com/advisory/ntap-20180601-0004/\", \"https://support.hpe.com/hpsc/doc/public/display?docLocale=en_US&docId=emr_na-hpesbux03909en_us\", \"https://usn.ubuntu.com/3627-1/\", \"https://usn.ubuntu.com/3627-2/\", \"https://www.debian.org/security/2018/dsa-4164\"], \"cvss\": \"3.5\", \"summary\": \"In Apache httpd 2.4.0 to 2.4.29, when mod_session is configured to forward its session data to CGI applications (SessionEnv on, not the default), a remote user may influence their content by using a \"Session\" header. This comes from the \"HTTP_SESSION\" variable name used by mod_session to forward its data to CGIs, since the prefix \"HTTP_\" is also used by the Apache HTTP Server to pass HTTP header fields, per CGI specifications.\"}, \"CVE-2015-3184\": {\"verified\": false, \"references\": [\"http://lists.apple.com/archives/security-announce/2016/Mar/msg00003.html\", \"http://lists.opensuse.org/opensuse-updates/2015-08/msg00022.html\", \"http://rhn.redhat.com/errata/RHSA-2015-1742.html\", \"http://subversion.apache.org/security/CVE-2015-3184-advisory.txt\", \"http://www.debian.org/security/2015/dsa-3331\", \"http://www.securityfocus.com/bid/76274\", \"http://www.securitytracker.com/id/1033215\", \"http://www.ubuntu.com/usn/USN-2721-1\", \"https://security.gentoo.org/glsa/201610-05\", \"https://support.apple.com/HT206172\"], \"cvss\": 5.0, \"summary\": \"mod_authz_svn in Apache Subversion 1.7.x before 1.7.21 and 1.8.x before 1.8.14, when using Apache httpd 2.4.x, does not properly restrict anonymous access, which allows remote anonymous users to read hidden files via the path name.\"}, \"CVE-2017-3167\": {\"verified\": false, \"references\": [\"http://www.debian.org/security/2017/dsa-3896\", \"http://www.oracle.com/technetwork/security-advisory/cpuoct2017-3236626.html\", \"http://www.securityfocus.com/bid/99135\", \"http://www.securitytracker.com/id/1038711\", \"https://access.redhat.com/errata/RHSA-2017:2478\", \"https://access.redhat.com/errata/RHSA-2017:2479\", \"https://access.redhat.com/errata/RHSA-2017:2483\", \"https://access.redhat.com/errata/RHSA-2017:3193\", \"https://access.redhat.com/errata/RHSA-2017:3194\", \"https://access.redhat.com/errata/RHSA-2017:3195\", \"https://access.redhat.com/errata/RHSA-2017:3475\", \"https://access.redhat.com/errata/RHSA-2017:3476\", \"https://access.redhat.com/errata/RHSA-2017:3477\", \"https://lists.apache.org/thread.html/8409e41a8f7dd9ded37141c38df001be930115428c3d64f70bbdb8b4@%3Cdev.httpd.apache.org%3E\", \"https://security.gentoo.org/glsa/201710-32\", \"https://security.netapp.com/advisory/ntap-20180601-0002/\", \"https://support.apple.com/HT208221\", \"https://support.hpe.com/hpsc/doc/public/display?docLocale=en_US&docId=emr_na-hpesbux03908en_us\", \"https://www.nomachine.com/SU08O00185\"], \"cvss\": \"7.5\", \"summary\": \"In Apache httpd 2.2.x before 2.2.33 and 2.4.x before 2.4.26, use of the ap_get_basic_auth_pw() by third-party modules outside of the authentication phase may lead to authentication requirements being bypassed.\"}, \"CVE-2017-9798\": {\"verified\": false, \"references\": [\"http://openwall.com/lists/oss-security/2017/09/18/2\", \"http://www.debian.org/security/2017/dsa-3980\", \"http://www.oracle.com/technetwork/security-advisory/cpuapr2018-3678067.html\", \"http://www.oracle.com/technetwork/security-advisory/cpujan2018-3236628.html\", \"http://www.oracle.com/technetwork/security-advisory/cpujul2018-4258247.html\", \"http://www.oracle.com/technetwork/security-advisory/cpuoct2018-4428296.html\", \"http://www.securityfocus.com/bid/100872\", \"http://www.securityfocus.com/bid/105598\", \"http://www.securitytracker.com/id/1039387\", \"https://access.redhat.com/errata/RHSA-2017:2882\", \"https://access.redhat.com/errata/RHSA-2017:2972\", \"https://access.redhat.com/errata/RHSA-2017:3018\", \"https://access.redhat.com/errata/RHSA-2017:3113\", \"https://access.redhat.com/errata/RHSA-2017:3114\", \"https://access.redhat.com/errata/RHSA-2017:3193\", \"https://access.redhat.com/errata/RHSA-2017:3194\", \"https://access.redhat.com/errata/RHSA-2017:3195\", \"https://access.redhat.com/errata/RHSA-2017:3239\", \"https://access.redhat.com/errata/RHSA-2017:3240\", \"https://access.redhat.com/errata/RHSA-2017:3475\", \"https://access.redhat.com/errata/RHSA-2017:3476\", \"https://access.redhat.com/errata/RHSA-2017:3477\", \"https://blog.fuzzing-project.org/60-Optionsbleed-HTTP-OPTIONS-method-can-leak-Apaches-server-memory.html\", \"https://blog.fuzzing-project.org/uploads/apache-2.2-optionsbleed-backport.patch\", \"https://github.com/apache/httpd/commit/29afdd2550b3d30a8defece2b95ae81edcf66ac9\", \"https://github.com/hannob/optionsbleed\", \"https://httpd.apache.org/security/vulnerabilities_24.html#CVE-2017-9798\", \"https://security-tracker.debian.org/tracker/CVE-2017-9798\", \"https://security.gentoo.org/glsa/201710-32\", \"https://security.netapp.com/advisory/ntap-20180601-0003/\", \"https://support.apple.com/HT208331\", \"https://support.hpe.com/hpsc/doc/public/display?docLocale=en_US&docId=emr_na-hpesbux03909en_us\", \"https://svn.apache.org/viewvc/httpd/httpd/branches/2.4.x/server/core.c?r1=1805223&r2=1807754&pathrev=1807754&view=patch\", \"https://www.exploit-db.com/exploits/42745/\", \"https://www.oracle.com/technetwork/security-advisory/cpuapr2019-5072813.html\", \"https://www.oracle.com/technetwork/security-advisory/cpujan2019-5072801.html\"], \"cvss\": \"5.0\", \"summary\": \"Apache httpd allows remote attackers to read secret data from process memory if the Limit directive can be set in a user's .htaccess file, or if httpd.conf has certain misconfigurations, aka Optionsbleed. This affects the Apache HTTP Server through 2.2.34 and 2.4.x through 2.4.27. The attacker sends an unauthenticated OPTIONS HTTP request when attempting to read secret data. This is a use-after-free issue and thus secret data is not always sent, and the specific data depends on many factors including configuration. Exploitation with .htaccess can be blocked with a patch to the ap_limit_section function in server/core.c.\"}, \"CVE-2016-8743\": {\"verified\": false, \"references\": [\"http://rhn.redhat.com/errata/RHSA-2017-1415.html\", \"http://www.debian.org/security/2017/dsa-3796\", \"http://www.securityfocus.com/bid/95077\", \"http://www.securitytracker.com/id/1037508\", \"https://access.redhat.com/errata/RHSA-2017:0906\", \"https://access.redhat.com/errata/RHSA-2017:1161\", \"https://access.redhat.com/errata/RHSA-2017:1413\", \"https://access.redhat.com/errata/RHSA-2017:1414\", \"https://access.redhat.com/errata/RHSA-2017:1721\", \"https://h20566.www2.hpe.com/hpsc/doc/public/display?docLocale=en_US&docId=emr_na-hpesbmu03753en_us\", \"https://h20566.www2.hpe.com/hpsc/doc/public/display?docLocale=en_US&docId=emr_na-hpesbux03725en_us\", \"https://httpd.apache.org/security/vulnerabilities_24.html#CVE-2016-8743\", \"https://security.gentoo.org/glsa/201701-36\", \"https://security.netapp.com/advisory/ntap-20180423-0001/\", \"https://support.apple.com/HT208221\", \"https://www.tenable.com/security/tns-2017-04\"], \"cvss\": 5.0, \"summary\": \"Apache HTTP Server, in all releases prior to 2.2.32 and 2.4.25, was liberal in the whitespace accepted from requests and sent in response lines and headers. Accepting these different behaviors represented a security concern when httpd participates in any chain of proxies or interacts with back-end application servers, either through mod_proxy or using conventional CGI mechanisms, and may result in request smuggling, response splitting and cache pollution.\"}, \"CVE-2017-15715\": {\"verified\": false, \"references\": [\"http://www.openwall.com/lists/oss-security/2018/03/24/6\", \"http://www.securityfocus.com/bid/103525\", \"http://www.securitytracker.com/id/1040570\", \"https://access.redhat.com/errata/RHSA-2018:3558\", \"https://access.redhat.com/errata/RHSA-2019:0366\", \"https://access.redhat.com/errata/RHSA-2019:0367\", \"https://httpd.apache.org/security/vulnerabilities_24.html\", \"https://lists.apache.org/thread.html/56c2e7cc9deb1c12a843d0dc251ea7fd3e7e80293cde02fcd65286ba@%3Ccvs.httpd.apache.org%3E\", \"https://security.netapp.com/advisory/ntap-20180601-0004/\", \"https://support.hpe.com/hpsc/doc/public/display?docLocale=en_US&docId=emr_na-hpesbux03909en_us\", \"https://usn.ubuntu.com/3627-1/\", \"https://usn.ubuntu.com/3627-2/\", \"https://www.debian.org/security/2018/dsa-4164\"], \"cvss\": \"6.8\", \"summary\": \"In Apache httpd 2.4.0 to 2.4.29, the expression specified in <FilesMatch> could match '$' to a newline character in a malicious filename, rather than matching only the end of the filename. This could be exploited in environments where uploads of some files are are externally blocked, but only by matching the trailing portion of the filename.\"}, \"CVE-2017-7668\": {\"verified\": false, \"references\": [\"http://www.debian.org/security/2017/dsa-3896\", \"http://www.oracle.com/technetwork/security-advisory/cpuoct2017-3236626.html\", \"http://www.securityfocus.com/bid/99137\", \"http://www.securitytracker.com/id/1038711\", \"https://access.redhat.com/errata/RHSA-2017:2479\", \"https://access.redhat.com/errata/RHSA-2017:2483\", \"https://access.redhat.com/errata/RHSA-2017:3193\", \"https://access.redhat.com/errata/RHSA-2017:3194\", \"https://lists.apache.org/thread.html/55a068b6a5eec0b3198ae7d96a7cb412352d0ffa7716612c5af3745b@%3Cdev.httpd.apache.org%3E\", \"https://security.gentoo.org/glsa/201710-32\", \"https://security.netapp.com/advisory/ntap-20180601-0002/\", \"https://support.apple.com/HT208221\", \"https://support.hpe.com/hpsc/doc/public/display?docLocale=en_US&docId=emr_na-hpesbhf03821en_us\", \"https://support.hpe.com/hpsc/doc/public/display?docLocale=en_US&docId=emr_na-hpesbux03908en_us\"], \"cvss\": \"7.5\", \"summary\": \"The HTTP strict parsing changes added in Apache httpd 2.2.32 and 2.4.24 introduced a bug in token list parsing, which allows ap_find_token() to search past the end of its input string. By maliciously crafting a sequence of request headers, an attacker may be able to cause a segmentation fault, or to force ap_find_token() to return an incorrect value.\"}, \"CVE-2017-3169\": {\"verified\": false, \"references\": [\"http://www.debian.org/security/2017/dsa-3896\", \"http://www.oracle.com/technetwork/security-advisory/cpuoct2017-3236626.html\", \"http://www.securityfocus.com/bid/99134\", \"http://www.securitytracker.com/id/1038711\", \"https://access.redhat.com/errata/RHSA-2017:2478\", \"https://access.redhat.com/errata/RHSA-2017:2479\", \"https://access.redhat.com/errata/RHSA-2017:2483\", \"https://access.redhat.com/errata/RHSA-2017:3193\", \"https://access.redhat.com/errata/RHSA-2017:3194\", \"https://access.redhat.com/errata/RHSA-2017:3195\", \"https://access.redhat.com/errata/RHSA-2017:3475\", \"https://access.redhat.com/errata/RHSA-2017:3476\", \"https://access.redhat.com/errata/RHSA-2017:3477\", \"https://github.com/gottburgm/Exploits/tree/master/CVE-2017-3169\", \"https://lists.apache.org/thread.html/84bf7fcc5cad35d355f11839cbdd13cbc5ffc1d34675090bff0f96ae@%3Cdev.httpd.apache.org%3E\", \"https://security.gentoo.org/glsa/201710-32\", \"https://security.netapp.com/advisory/ntap-20180601-0002/\", \"https://support.apple.com/HT208221\", \"https://support.hpe.com/hpsc/doc/public/display?docLocale=en_US&docId=emr_na-hpesbux03908en_us\", \"https://www.nomachine.com/SU08O00185\"], \"cvss\": \"7.5\", \"summary\": \"In Apache httpd 2.2.x before 2.2.33 and 2.4.x before 2.4.26, mod_ssl may dereference a NULL pointer when third-party modules call ap_hook_process_connection() during an HTTP request to an HTTPS port.\"}, \"CVE-2016-4975\": {\"verified\": false, \"references\": [\"http://www.securityfocus.com/bid/105093\", \"https://httpd.apache.org/security/vulnerabilities_22.html#CVE-2016-4975\", \"https://httpd.apache.org/security/vulnerabilities_24.html#CVE-2016-4975\", \"https://security.netapp.com/advisory/ntap-20180926-0006/\", \"https://support.hpe.com/hpsc/doc/public/display?docLocale=en_US&docId=emr_na-hpesbux03908en_us\"], \"cvss\": \"4.3\", \"summary\": \"Possible CRLF injection allowing HTTP response splitting attacks for sites which use mod_userdir. This issue was mitigated by changes made in 2.4.25 and 2.2.32 which prohibit CR or LF injection into the \"Location\" or other outbound header key or value. Fixed in Apache HTTP Server 2.4.25 (Affected 2.4.1-2.4.23). Fixed in Apache HTTP Server 2.2.32 (Affected 2.2.0-2.2.31).\"}, \"CVE-2018-17199\": {\"verified\": false, \"references\": [\"http://www.securityfocus.com/bid/106742\", \"https://httpd.apache.org/security/vulnerabilities_24.html\", \"https://lists.debian.org/debian-lts-announce/2019/01/msg00024.html\", \"https://seclists.org/bugtraq/2019/Apr/5\", \"https://security.gentoo.org/glsa/201903-21\", \"https://security.netapp.com/advisory/ntap-20190125-0001/\", \"https://usn.ubuntu.com/3937-1/\", \"https://www.debian.org/security/2019/dsa-4422\", \"https://www.oracle.com/technetwork/security-advisory/cpuapr2019-5072813.html\", \"https://www.oracle.com/technetwork/security-advisory/cpujul2019-5072835.html\"], \"cvss\": \"5.0\", \"summary\": \"In Apache HTTP Server 2.4 release 2.4.37 and prior, mod_session checks the session expiry time before decoding the session. This causes session expiry time to be ignored for mod_session_cookie sessions since the expiry time is loaded when the session is decoded.\"}, \"CVE-2016-2161\": {\"verified\": false, \"references\": [\"http://rhn.redhat.com/errata/RHSA-2017-1415.html\", \"http://www.debian.org/security/2017/dsa-3796\", \"http://www.securityfocus.com/bid/95076\", \"http://www.securitytracker.com/id/1037508\", \"https://access.redhat.com/errata/RHSA-2017:0906\", \"https://access.redhat.com/errata/RHSA-2017:1161\", \"https://access.redhat.com/errata/RHSA-2017:1413\", \"https://access.redhat.com/errata/RHSA-2017:1414\", \"https://h20566.www2.hpe.com/hpsc/doc/public/display?docLocale=en_US&docId=emr_na-hpesbux03725en_us\", \"https://httpd.apache.org/security/vulnerabilities_24.html#CVE-2016-2161\", \"https://security.gentoo.org/glsa/201701-36\", \"https://security.netapp.com/advisory/ntap-20180423-0001/\", \"https://support.apple.com/HT208221\", \"https://www.tenable.com/security/tns-2017-04\"], \"cvss\": 5.0, \"summary\": \"In Apache HTTP Server versions 2.4.0 to 2.4.23, malicious input to mod_auth_digest can cause the server to crash, and each instance continues to crash even for subsequently valid requests.\"}, \"CVE-2018-1312\": {\"verified\": false, \"references\": [\"http://www.openwall.com/lists/oss-security/2018/03/24/7\", \"http://www.securityfocus.com/bid/103524\", \"http://www.securitytracker.com/id/1040571\", \"https://access.redhat.com/errata/RHSA-2018:3558\", \"https://access.redhat.com/errata/RHSA-2019:0366\", \"https://access.redhat.com/errata/RHSA-2019:0367\", \"https://access.redhat.com/errata/RHSA-2019:1898\", \"https://httpd.apache.org/security/vulnerabilities_24.html\", \"https://lists.debian.org/debian-lts-announce/2018/05/msg00020.html\", \"https://security.netapp.com/advisory/ntap-20180601-0004/\", \"https://support.hpe.com/hpsc/doc/public/display?docLocale=en_US&docId=emr_na-hpesbux03909en_us\", \"https://usn.ubuntu.com/3627-1/\", \"https://usn.ubuntu.com/3627-2/\", \"https://usn.ubuntu.com/3937-2/\", \"https://www.debian.org/security/2018/dsa-4164\"], \"cvss\": \"6.8\", \"summary\": \"In Apache httpd 2.2.0 to 2.4.29, when generating an HTTP Digest authentication challenge, the nonce sent to prevent reply attacks was not correctly generated using a pseudo-random seed. In a cluster of servers using a common Digest authentication configuration, HTTP requests could be replayed across servers by an attacker without detection.\"}}, \"http\": {\"status\": 200, \"robots_hash\": null, \"redirects\": [], \"securitytxt\": null, \"title\": \"Default site\", \"sitemap_hash\": null, \"robots\": null, \"server\": \"Apache/2.4.10 (Debian)\", \"host\": \"62.26.12.104\", \"html\": \"<!DOCTYPE html>\n<html>\n\t<head>\n\t\t<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n\t\t<title>Default site</title>\n\t\t<style type=\"text/css\">\n\t\t\t#ph_image {\n\t\t\t\twidth:    100%;\n\t\t\t\theight:   100%;\n\t\t\t\tposition: absolute;\n\n\t\t\t\tbackground-image:    url('images/placeholder.gif');\n\t\t\t\tbackground-repeat:   no-repeat;\n\t\t\t\tbackground-position: center 30%;\n\t\t\t}\n\t\t</style>\n\t</head>\n\t<body>\n\t\t<div id=\"ph_image\"></div>\n\t</body>\n</html>\n\n\", \"location\": \"/\", \"components\": {}, \"html_hash\": 1043193832, \"sitemap\": null, \"securitytxt_hash\": null}, \"port\": 443, \"transport\": \"tcp\", \"version\": \"2.4.10\", \"location\": {\"city\": \"Frankfurt am Main\", \"region_code\": \"HE\", \"area_code\": null, \"longitude\": 8.68417, \"latitude\": 50.11552, \"country_code\": \"DE\", \"country_name\": \"Germany\"}, \"ip\": 1041894504, \"product\": \"Apache httpd\", \"hash\": -799104851, \"tags\": [\"self-signed\"], \"timestamp\": \"2022-02-10T04:38:01.637154\", \"ssl\": {\"chain_sha256\": [\"04e8e09743799aa7c0f978da8a26d00070e6692483a7477b328bdf449245e2df\"], \"jarm\": \"07d10d11d21d21d07c07d10d07d21dc74a10f0dd8921b3cc912d3ee25ffd0a\", \"chain\": [\"-----BEGIN CERTIFICATE-----\nMIIC+DCCAeCgAwIBAgIJAKf/2AHJeHDGMA0GCSqGSIb3DQEBCwUAMDQxMjAwBgNV\nBAMMKXV4bmxFbW1lcmljaC5lbW1lcmljaC1leGNsdXNpdmJyaWxsZW4uY29tMB4X\nDTE2MDgzMTA2NDMzNloXDTI2MDgyOTA2NDMzNlowNDEyMDAGA1UEAwwpdXhubEVt\nbWVyaWNoLmVtbWVyaWNoLWV4Y2x1c2l2YnJpbGxlbi5jb20wggEiMA0GCSqGSIb3\nDQEBAQUAA4IBDwAwggEKAoIBAQDNDJ0vsL7drYMDb4fcStKe7rAvaIQkwryoF5Ne\nQ4YvB8b+PPioF4lUzJx6e0CnjFxpbpLOKsyZ06/V7KXXIcH01h0LQgYHsIF/kkpt\nMwF/dQzShaDZoUA06mRvUDjn7I6qJXt9a8u/19PthDn8ceaKmY/p5WuQWpkMz+av\nKVEcwYAxsKaTY64piznPfDtzfxEmME0ZnrbOpmoWOEf1IB9ng7klGQ5nObjTOvoK\nBiA3kUR5E4iPWlI67N0ord11lescQrv4gSu3iVg9Dm2XF0MWw7xXrC7CdtA+BUxq\nBmzTno5NxyY6BIK+8NFBvm4nXUOeQx0mbLkbrKBqAr1Q3eDtAgMBAAGjDTALMAkG\nA1UdEwQCMAAwDQYJKoZIhvcNAQELBQADggEBAJEZg2tnBBYbtdsmgkmWDvxxsXcz\nQne4xqckwJLMdpMvdzOsY5E5gGUvyDgvqSN3OGuGljv3qJIGi4E+HhsSpyh9/yUg\nNQC+ZIpM0Dg362eT13kL3hLSEdZC0sZVuSju2L15BgYVWw1azUE40nK+c7WOsSsS\ncpTsBOKlpnUOh1CIa8q9o/DuPecbWU7rwjnmL5dxEvsNTSCzcsRfj48SeFGosPD1\nYhkrWep+hetgk9FX5AcO6Xyfk6XIhaP8UiLchvdspalJQG8L51uYcrzBEp9obz61\n0+WPUCe/Luii3WEFLtS64/NNWBjEoLOHVgoml66gY4r5/xxnW79W+tGND3o=\n-----END CERTIFICATE-----\n\"], \"dhparams\": {\"prime\": \"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff\", \"public_key\": \"ef0af7b8eeca7cbe6f8837a430d6f8dfeb1cfae14206e77169004fa535f4014170d03b0469e6d38d5f6158f1cfe967647e0ce5148226c5142a35bb1f29cc122421eff74f50e90b6e1d6ab983b41df4fc9c0670e84bfa1786578f847487ec1d0e2dda0ac4c1d92a50007f615928d4a4c83e26c029325201f0626b208c95fd4cff238d9a43f304d3ef6780f05398edf4f66af7306f91667cc7cb68cbc2778fed73566f5a1f0018e2b1856ebfcb01f4fea89e85f64c9f85c97dfe9e49d182545f3fb261c3fd7093750c5939f2ca92dfe337be186b01d0a0b375e51ab08269ee6aaec4928a9fc7df1afe881757b676600b1e9327eb8b2f7be97cf7e5cb1a196c34d6\", \"bits\": 2048, \"generator\": 2, \"fingerprint\": \"RFC3526/Oakley Group 14\"}, \"versions\": [\"TLSv1\", \"-SSLv2\", \"-SSLv3\", \"TLSv1.1\", \"TLSv1.2\", \"-TLSv1.3\"], \"acceptable_cas\": [], \"tlsext\": [{\"id\": 65281, \"name\": \"renegotiation_info\"}, {\"id\": 11, \"name\": \"ec_point_formats\"}, {\"id\": 35, \"name\": \"session_ticket\"}, {\"id\": 15, \"name\": \"heartbeat\"}], \"ja3s\": \"f6e234011390444c303f74d09d87322d\", \"cert\": {\"sig_alg\": \"sha256WithRSAEncryption\", \"issued\": \"20160831064336Z\", \"expires\": \"20260829064336Z\", \"expired\": false, \"version\": 2, \"extensions\": [{\"data\": \"0\x00\", \"name\": \"basicConstraints\"}], \"fingerprint\": {\"sha256\": \"04e8e09743799aa7c0f978da8a26d00070e6692483a7477b328bdf449245e2df\", \"sha1\": \"f4212825964b545928ee9210f88704cfda7fb835\"}, \"serial\": 12105631825581863110, \"subject\": {\"CN\": \"uxnlEmmerich.emmerich-exclusivbrillen.com\"}, \"pubkey\": {\"type\": \"rsa\", \"bits\": 2048}, \"issuer\": {\"CN\": \"uxnlEmmerich.emmerich-exclusivbrillen.com\"}}, \"cipher\": {\"version\": \"TLSv1/SSLv3\", \"bits\": 256, \"name\": \"ECDHE-RSA-AES256-GCM-SHA384\"}, \"trust\": {\"revoked\": false, \"browser\": null}, \"handshake_states\": [\"before/connect initialization\", \"SSLv2/v3 write client hello\", \"SSLv2/v3 read server hello\", \"SSLv3/TLS read server hello\", \"SSLv3/TLS read server certificate\", \"SSLv3/TLS read server key exchange\", \"SSLv3/TLS read server done\", \"SSLv3/TLS write client key exchange\", \"SSLv3/TLS write change cipher spec\", \"SSLv3/TLS write finished\", \"SSLv3/TLS flush data\", \"SSLv3/TLS read server session ticket\", \"SSLv3/TLS read finished\", \"SSL negotiation finished successfully\"], \"alpn\": [], \"ocsp\": {}}, \"hostnames\": [], \"org\": \"NetLeaders GmbH & Co. KG\", \"data\": \"HTTP/1.1 200 OK\r\nDate: Thu, 10 Feb 2022 04:38:01 GMT\r\nServer: Apache/2.4.10 (Debian)\r\nLast-Modified: Wed, 31 Aug 2016 06:48:14 GMT\r\nETag: \"1bd-53b587b46b76d\"\r\nAccept-Ranges: bytes\r\nContent-Length: 445\r\nVary: Accept-Encoding\r\nContent-Type: text/html\r\n\r\n\", \"asn\": \"AS12312\", \"cpe23\": [\"cpe:2.3:a:apache:http_server:2.4.10\"], \"info\": \"(Debian)\", \"isp\": \"ecotel communication ag\", \"cpe\": [\"cpe:/a:apache:http_server:2.4.10\"], \"domains\": [], \"ip_str\": \"62.26.12.104\", \"os\": null, \"_shodan\": {\"crawler\": \"f4bb88763d8ed3a0f3f91439c2c62b77fb9e06f3\", \"options\": {}, \"id\": \"6f7a2af6-3303-4fac-a6f3-57f7676b1080\", \"module\": \"https\", \"ptr\": true}, \"opts\": {\"vulns\": [], \"heartbleed\": \"2022/02/10 04:39:09 62.26.12.104:443 - SAFE\n\"}}], \"asn\": \"AS12312\", \"ip_str\": \"62.26.12.104\"}";
            return JsonSerializer.Deserialize<ShodanInfo>(shodanResponseString);
        }

        public async Task ScanIpsAsync(ApplicationDbContext context)
        {
            var servers = await _context.Servers.ToListAsync();
            if (servers is null)
                return;
            foreach (var server in servers)
            {
                var url = new Uri("https://api.shodan.io/shodan/host/" + server.Ip + "?key=" + apiKey);
                var shodanInfo = await ScanIpAsync(server.Ip, url);
                await server.ChangeStateAsync(shodanInfo, server, context);
            }
        }
    }
}
